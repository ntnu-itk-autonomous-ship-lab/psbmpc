legend_strs = strings(n_obst + 2, 1);
legend_strs(1) = 'total cost';
legend_strs(2) = 'cost cb ch g'; 
count = 3;
for i = 1 : n_obst
    legend_strs(count) = ['cost i=' num2str(i)]; 
    count = count + 1;
end

figure(1); 
hold on; grid on;
plot(total_cost, 'b');
plot(cost_cb_ch_g, 'r');
for i = 1 : n_obst
    plot(cost_i(i, :));
end

legend(legend_strs, 'location', 'northeast');
ylabel('cost');
xlabel('cb index');

index = 1;
max_cost_legend_strs = cell(1, n_obst);
for i = 1 : n_obst
    max_cost_legend_strs{i} = strings(1, n_ps(i));
    for ps = 1 : n_ps(i)
        max_cost_legend_strs{i}(ps) = strcat('ps=', num2str(ps));
    end
    figure(i + 1);
    title(strcat('Obstacle i = ', num2str(i), ' | Max cost ps'));
    grid on;
    plot(max_cost_ps(index : index + n_ps(i), :)');
    legend(max_cost_legend_strs{i});
    ylabel('cost');
    xlabel('cb index');
end

% printf index of optimal control behaviour
fprintf('Optimum control behaviour index = %d\n', opt_cb_index);
frintf('Corresponding control behaviour'

save('gpu_psbmpc_cost_data', 'total_cost', 'cost_i', 'max_cost_ps', 'cost_cb_ch_g', ...
    'n_obst', 'n_ps', 'cb_matrix', 'opt_cb_index');