persistent ps_counter;
if isempty(ps_counter)
    ps_counter = 1;
else
    ps_counter = ps_counter + 1;
end
plot(X_i(2, :), X_i(1, :), 'g');

x_cs = 50 * cos(th); y_cs = 50 * sin(th);
for k = 1 : 50 : n_samples
    ell = create_probability_contour(reshape(P_flat(:, k), 4, 4));
    plot(ell(:, 2) + X_i(2, k), ell(:, 1) + X_i(1, k), 'c');
    
    plot(y_cs + X(2, k), x_cs + X(1, k), 'r');
end

legend('OS', 'WPs', '(i, ps)');

figure;
hold on; grid on; axis equal;
plot(X_i(3, :), 'g');
plot(X_i(4, :), 'c');
